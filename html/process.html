<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>process module &mdash; Goodman Spectroscopic Tools 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Goodman Spectroscopic Tools 0.1 documentation" href="index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Goodman Spectroscopic Tools 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-process">
<span id="process-module"></span><h1>process module<a class="headerlink" href="#module-process" title="Permalink to this headline">¶</a></h1>
<p>Module that handles intermediate processess</p>
<p>This module performs intermediate steps in the process to obtain a wavelength calibrated spectrum
the __call__ method returns a list contained uni-dimensional data extracted and the modified instance of ScienceObject</p>
<dl class="class">
<dt id="process.IdentifiedTarget">
<em class="property">class </em><code class="descclassname">process.</code><code class="descname">IdentifiedTarget</code><span class="sig-paren">(</span><em>amplitude</em>, <em>mean</em>, <em>stddev</em>, <em>fwhmg=0</em>, <em>raw_width=None</em>, <em>sample_loc=None</em><span class="sig-paren">)</span><a class="headerlink" href="#process.IdentifiedTarget" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Allows for easy storage and manipulation of the targets found.</p>
<dl class="method">
<dt id="process.IdentifiedTarget.print_all">
<code class="descname">print_all</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#process.IdentifiedTarget.print_all" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="process.Process">
<em class="property">class </em><code class="descclassname">process.</code><code class="descname">Process</code><span class="sig-paren">(</span><em>sci_obj</em>, <em>args</em><span class="sig-paren">)</span><a class="headerlink" href="#process.Process" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Set of tools for extracting Goodman High Throughput Spectrograph data.</p>
<p>This class needs a path parsed as a string and a ScienceObject object. The ScienceObject class is defined in the
module redspec.py and in principle the current module was made to service it. This class has been tested to work
very well independently given that you successfully provide the previously mentioned ScienceObject and respective
path to the data location.</p>
<dl class="staticmethod">
<dt id="process.Process.add_wcs_keys">
<em class="property">static </em><code class="descname">add_wcs_keys</code><span class="sig-paren">(</span><em>header</em><span class="sig-paren">)</span><a class="headerlink" href="#process.Process.add_wcs_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds generic keyword to the header</p>
<p>Linear wavelength solutions require a set of standard fits keywords. Later on they will be updated accordingly</p>
<p>The main goal of putting them here is to have consistent and nicely ordered headers</p>
</dd></dl>

<dl class="method">
<dt id="process.Process.extract">
<code class="descname">extract</code><span class="sig-paren">(</span><em>traces</em><span class="sig-paren">)</span><a class="headerlink" href="#process.Process.extract" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts the spectra and returns an stack of science data and lamps</p>
<p>Apart of traces this function makes use of the class attribute region which contains a mask for the extraction
zones identified different for science targets and for background zones. The background subtraction is only
used for the science targets since it would not make sense to do it for lamps.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>traces</strong> (<em>list</em>) &#8211; Contains a list per each science target previously detected. Every list has two elements
that are: Chebyshev fitted to spectrum peaks along the full extension of the spectrum or along the
full length of the dispersion axis.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>sci_pack</strong> &#8211; The sci_pack is list that contains two main elements. The first contains all the data and
the second contains the headers in the same order. In the first element, the first is always the science
target and the following are lamps that are not calibrated yet. Again, the same order for the headers.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="process.Process.identify_spectra">
<code class="descname">identify_spectra</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#process.Process.identify_spectra" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="process.Process.mask">
<code class="descname">mask</code><span class="sig-paren">(</span><em>mask_min</em>, <em>mask_max</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#process.Process.mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Masks the region that will be extracted</p>
<p>The class Process has the attribute region (self.region) which is a section across the spatial direction of the
image being processed. It is filled with ones (1) meaning that is _free <a href="#id1"><span class="problematic" id="id2">zone_</span></a>. Every time a new science
target is found a mask will be created with -1 values. This type of mask has priority over all the rest.
For every science target two background extraction zones are defined and masked with 0 but if they
interfere with another science target they will be ignored.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mask_min</strong> (<em>int</em>) &#8211; Starting point to the region to be masked</li>
<li><strong>mask_max</strong> (<em>int</em>) &#8211; Ending point to the region to be masked</li>
<li><strong>value</strong> (<em>int</em>) &#8211; Value to be replaced. -1 is for science targets and 0 for background regions.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">True if the masking suceeds or false if it fails.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">True or False</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="process.Process.trace">
<code class="descname">trace</code><span class="sig-paren">(</span><em>targets</em><span class="sig-paren">)</span><a class="headerlink" href="#process.Process.trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the trace of a spectrum given an initial location</p>
<p>From the input data it finds the location of the spectrum in the image and an approximate width of six sigmas,
with that information it takes a sample of the data just covering those limits to speed up the process.
It takes about fifty sub-samples along the dispersion direction with a width of fifty pixels each.
All the parameters can be changed with the variables half_n_sigma, ends_pix_spacing, n_samples and
sample_width variables. The sub-samples are flattened along the dispersion direction using numpy.median and
the location of the maximum value is recorded. Alternatively is possible to do a gaussian fit but my tests
suggest is not much what you earn with this now is disabled by default. Enable it by changing do_gaussian_fit to
True. Once there is a list of maximum locations a Chebyshev 1D of second order is fitted to define the trace.
The Chebyshev function is defined for all the range of pixels in the dispersion direction of the image.
This method also mask the regions that will be extracted as science target (or spectrum) and the regions
that will be used for background subtractions. At first two regions are defined for each science target
at each side by an offset defined by the background_offset variable and the same width as the science target&#8217;s
aperture. If there are background subtraction regions that fall into a science target they will be ignored.
In that case only one background region will be used.
If both subtraction regions are valid they will be averaged and then subtracted.
If no background region are valid, no background subtraction will happen.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is not worth doing gaussian fits to the sub samples since it will not improve the result. The only case
this might be useful is the case when someone does an interpolation along the spatial direction.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>targets</strong> (<em>list</em>) &#8211; Each element is a class that stores the parameters of the gaussian fitted to the data in
previous steps. This data tells the location in the image of the target or targets.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>traces</strong> &#8211;<dl class="docutils">
<dt>Every element is a list with two elements. The first is the fitted Chebyshev and the</dt>
<dd>second and last is the width to be extracted.</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="process.SciencePack">
<em class="property">class </em><code class="descclassname">process.</code><code class="descname">SciencePack</code><a class="headerlink" href="#process.SciencePack" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="process.SciencePack.add_data">
<code class="descname">add_data</code><span class="sig-paren">(</span><em>new_data</em><span class="sig-paren">)</span><a class="headerlink" href="#process.SciencePack.add_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="process.SciencePack.add_header">
<code class="descname">add_header</code><span class="sig-paren">(</span><em>new_header</em><span class="sig-paren">)</span><a class="headerlink" href="#process.SciencePack.add_header" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="process.SciencePack.add_lamp">
<code class="descname">add_lamp</code><span class="sig-paren">(</span><em>new_lamp</em><span class="sig-paren">)</span><a class="headerlink" href="#process.SciencePack.add_lamp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="process.SciencePack.add_lamp_header">
<code class="descname">add_lamp_header</code><span class="sig-paren">(</span><em>new_lamp_header</em><span class="sig-paren">)</span><a class="headerlink" href="#process.SciencePack.add_lamp_header" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="process.SciencePack.check_consistency">
<code class="descname">check_consistency</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#process.SciencePack.check_consistency" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/process.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Goodman Spectroscopic Tools 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Simon Torres R..
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.5.
    </div>
  </body>
</html>